-- connect 'jdbc:splice://localhost:1527/splicedb;user=splice;password=admin';

call syscs_util.syscs_create_user('longdb', 'admin');

grant all privileges on schema SPLICE to longdb;

-- connect 'jdbc:splice://localhost:1527/splicedb;user=longdb;password=admin';

CREATE SCHEMA TPCH;
CREATE SCHEMA TPCH2;
-- SET SCHEMA tpch;

-- grant all privileges on schema LONGDB to longdb;

CREATE TABLE TPCH.CUSTOMER (
	C_CUSTKEY INTEGER NOT NULL,
	C_NAME VARCHAR(25),
	C_ADDRESS VARCHAR(40),
	C_NATIONKEY INTEGER NOT NULL,
	C_PHONE VARCHAR(15),
	C_ACCTBAL DECIMAL(15,2),
	C_MKTSEGMENT VARCHAR(10),
	C_COMMENT VARCHAR(117),
	CONSTRAINT SQL190510132245880 PRIMARY KEY (C_CUSTKEY)
);

CREATE TABLE TPCH.LINEITEM (
	L_ORDERKEY BIGINT NOT NULL,
	L_PARTKEY INTEGER NOT NULL,
	L_SUPPKEY INTEGER NOT NULL,
	L_LINENUMBER INTEGER NOT NULL,
	L_QUANTITY DECIMAL(15,2),
	L_EXTENDEDPRICE DECIMAL(15,2),
	L_DISCOUNT DECIMAL(15,2),
	L_TAX DECIMAL(15,2),
	L_RETURNFLAG VARCHAR(1),
	L_LINESTATUS VARCHAR(1),
	L_SHIPDATE DATE,
	L_COMMITDATE DATE,
	L_RECEIPTDATE DATE,
	L_SHIPINSTRUCT VARCHAR(25),
	L_SHIPMODE VARCHAR(10),
	L_COMMENT VARCHAR(44),
	CONSTRAINT SQL190510132230530 PRIMARY KEY (L_ORDERKEY,L_LINENUMBER)
);

CREATE TABLE TPCH.NATION (
	N_NATIONKEY INTEGER NOT NULL,
	N_NAME VARCHAR(25),
	N_REGIONKEY INTEGER NOT NULL,
	N_COMMENT VARCHAR(152),
	CONSTRAINT SQL190510132319210 PRIMARY KEY (N_NATIONKEY)
);

CREATE TABLE TPCH.ORDERS (
	O_ORDERKEY BIGINT NOT NULL,
	O_CUSTKEY INTEGER,
	O_ORDERSTATUS VARCHAR(1),
	O_TOTALPRICE DECIMAL(15,2),
	O_ORDERDATE DATE,
	O_ORDERPRIORITY VARCHAR(15),
	O_CLERK VARCHAR(15),
	O_SHIPPRIORITY INTEGER,
	O_COMMENT VARCHAR(79),
	CONSTRAINT SQL190510132239760 PRIMARY KEY (O_ORDERKEY)
);

CREATE TABLE TPCH.PART (
	P_PARTKEY INTEGER NOT NULL,
	P_NAME VARCHAR(55),
	P_MFGR VARCHAR(25),
	P_BRAND VARCHAR(10),
	P_TYPE VARCHAR(25),
	P_SIZE INTEGER,
	P_CONTAINER VARCHAR(10),
	P_RETAILPRICE DECIMAL(15,2),
	P_COMMENT VARCHAR(23),
	CONSTRAINT SQL190510132303460 PRIMARY KEY (P_PARTKEY)
);


CREATE TABLE TPCH.PARTSUPP (
	PS_PARTKEY INTEGER NOT NULL,
	PS_SUPPKEY INTEGER NOT NULL,
	PS_AVAILQTY INTEGER,
	PS_SUPPLYCOST DECIMAL(15,2),
	PS_COMMENT VARCHAR(199),
	CONSTRAINT SQL190510132251770 PRIMARY KEY (PS_PARTKEY,PS_SUPPKEY)
);

CREATE TABLE TPCH.REGION (
	R_REGIONKEY INTEGER NOT NULL,
	R_NAME VARCHAR(25),
	R_COMMENT VARCHAR(152),
	CONSTRAINT SQL190510132309350 PRIMARY KEY (R_REGIONKEY)
);

CREATE TABLE TPCH.SUPPLIER (
	S_SUPPKEY INTEGER NOT NULL,
	S_NAME VARCHAR(25),
	S_ADDRESS VARCHAR(40),
	S_NATIONKEY INTEGER,
	S_PHONE VARCHAR(15),
	S_ACCTBAL DECIMAL(15,2),
	S_COMMENT VARCHAR(101),
	CONSTRAINT SQL190510132256600 PRIMARY KEY (S_SUPPKEY)
);

CREATE TABLE TPCH2.CUSTOMER (
	C_CUSTKEY INTEGER NOT NULL,
	C_NAME VARCHAR(25),
	C_ADDRESS VARCHAR(40),
	C_NATIONKEY INTEGER NOT NULL,
	C_PHONE VARCHAR(15),
	C_ACCTBAL DECIMAL(15,2),
	C_MKTSEGMENT VARCHAR(10),
	C_COMMENT VARCHAR(117)
);

CREATE TABLE TPCH2.LINEITEM (
	L_ORDERKEY BIGINT NOT NULL,
	L_PARTKEY INTEGER NOT NULL,
	L_SUPPKEY INTEGER NOT NULL,
	L_LINENUMBER INTEGER NOT NULL,
	L_QUANTITY DECIMAL(15,2),
	L_EXTENDEDPRICE DECIMAL(15,2),
	L_DISCOUNT DECIMAL(15,2),
	L_TAX DECIMAL(15,2),
	L_RETURNFLAG VARCHAR(1),
	L_LINESTATUS VARCHAR(1),
	L_SHIPDATE DATE,
	L_COMMITDATE DATE,
	L_RECEIPTDATE DATE,
	L_SHIPINSTRUCT VARCHAR(25),
	L_SHIPMODE VARCHAR(10),
	L_COMMENT VARCHAR(44)
);

CREATE TABLE TPCH2.NATION (
	N_NATIONKEY INTEGER NOT NULL,
	N_NAME VARCHAR(25),
	N_REGIONKEY INTEGER NOT NULL,
	N_COMMENT VARCHAR(152)
);

CREATE TABLE TPCH2.ORDERS (
	O_ORDERKEY BIGINT NOT NULL,
	O_CUSTKEY INTEGER,
	O_ORDERSTATUS VARCHAR(1),
	O_TOTALPRICE DECIMAL(15,2),
	O_ORDERDATE DATE,
	O_ORDERPRIORITY VARCHAR(15),
	O_CLERK VARCHAR(15),
	O_SHIPPRIORITY INTEGER,
	O_COMMENT VARCHAR(79)
);

CREATE TABLE TPCH2.PART (
	P_PARTKEY INTEGER NOT NULL,
	P_NAME VARCHAR(55),
	P_MFGR VARCHAR(25),
	P_BRAND VARCHAR(10),
	P_TYPE VARCHAR(25),
	P_SIZE INTEGER,
	P_CONTAINER VARCHAR(10),
	P_RETAILPRICE DECIMAL(15,2),
	P_COMMENT VARCHAR(23)
);


CREATE TABLE TPCH2.PARTSUPP (
	PS_PARTKEY INTEGER NOT NULL,
	PS_SUPPKEY INTEGER NOT NULL,
	PS_AVAILQTY INTEGER,
	PS_SUPPLYCOST DECIMAL(15,2),
	PS_COMMENT VARCHAR(199)
);

CREATE TABLE TPCH2.REGION (
	R_REGIONKEY INTEGER NOT NULL,
	R_NAME VARCHAR(25),
	R_COMMENT VARCHAR(152)
);

CREATE TABLE TPCH2.SUPPLIER (
	S_SUPPKEY INTEGER NOT NULL,
	S_NAME VARCHAR(25),
	S_ADDRESS VARCHAR(40),
	S_NATIONKEY INTEGER,
	S_PHONE VARCHAR(15),
	S_ACCTBAL DECIMAL(15,2),
	S_COMMENT VARCHAR(101)
);

grant all privileges on schema TPCH to longdb;
grant all privileges on schema TPCH2 to longdb;

call SYSCS_UTIL.IMPORT_DATA('TPCH', 'customer', null, '/opt/data/db_init/customer.tbl','|', null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH', 'lineitem', null, '/opt/data/db_init/lineitem.tbl','|', null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH', 'orders', null, '/opt/data/db_init/orders.tbl','|', null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH', 'nation', null, '/opt/data/db_init/nation.tbl','|', null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH', 'part', null, '/opt/data/db_init/part.tbl','|', null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH', 'partsupp', null, '/opt/data/db_init/partsupp.tbl','|', null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH', 'region', null, '/opt/data/db_init/region.tbl','|', null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH', 'supplier', null, '/opt/data/db_init/supplier.tbl','|', null, null, null, null, 0, '/opt/data/db_init/bad', true, null);


call SYSCS_UTIL.IMPORT_DATA('TPCH2', 'customer', null, '/opt/data/db_init/TPCH2/CUSTOMER.csv',null, null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH2', 'lineitem', null, '/opt/data/db_init/TPCH2/LINEITEM.csv',null, null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH2', 'orders', null, '/opt/data/db_init/TPCH2/ORDERS.csv',null, null, null, null, null, 0, '/opt/data/db_init/bad', true, null);
call SYSCS_UTIL.IMPORT_DATA('TPCH2', 'supplier', null, '/opt/data/db_init/TPCH2/SUPPLIER.csv',null, null, null, null, null, 0, '/opt/data/db_init/bad', true, null);


